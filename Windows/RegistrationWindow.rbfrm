#tag WindowBegin Window RegistrationWindow   BackColor       =   &cFFFFFF00   Backdrop        =   0   CloseButton     =   True   Compatibility   =   ""   Composite       =   True   Frame           =   8   FullScreen      =   False   FullScreenButton=   False   HasBackColor    =   False   Height          =   186   ImplicitInstance=   True   LiveResize      =   True   MacProcID       =   0   MaxHeight       =   32000   MaximizeButton  =   False   MaxWidth        =   32000   MenuBar         =   0   MenuBarVisible  =   True   MinHeight       =   64   MinimizeButton  =   True   MinWidth        =   64   Placement       =   0   Resizeable      =   False   Title           =   "cubeSQL Registration"   Visible         =   True   Width           =   490   Begin Label RegistrationField1      AutoDeactivate  =   True      Bold            =   True      DataField       =   ""      DataSource      =   ""      Enabled         =   True      Height          =   20      HelpTag         =   ""      Index           =   -2147483648      InitialParent   =   ""      Italic          =   False      Left            =   20      LockBottom      =   False      LockedInPosition=   False      LockLeft        =   False      LockRight       =   False      LockTop         =   False      Multiline       =   False      Scope           =   0      Selectable      =   False      TabIndex        =   0      TabPanelIndex   =   0      Text            =   "cubeSQL Server Registration"      TextAlign       =   0      TextColor       =   &c00000000      TextFont        =   "System"      TextSize        =   0.0      TextUnit        =   0      Top             =   14      Transparent     =   True      Underline       =   False      Visible         =   True      Width           =   386   End   Begin TextField NameField      AcceptTabs      =   False      Alignment       =   0      AutoDeactivate  =   True      AutomaticallyCheckSpelling=   False      BackColor       =   &cFFFFFF00      Bold            =   False      Border          =   True      CueText         =   ""      DataField       =   ""      DataSource      =   ""      Enabled         =   True      Format          =   ""      Height          =   22      HelpTag         =   ""      Index           =   -2147483648      InitialParent   =   ""      Italic          =   False      Left            =   89      LimitText       =   0      LockBottom      =   False      LockedInPosition=   False      LockLeft        =   False      LockRight       =   False      LockTop         =   False      Mask            =   ""      Password        =   False      ReadOnly        =   False      Scope           =   0      TabIndex        =   3      TabPanelIndex   =   0      TabStop         =   True      Text            =   ""      TextColor       =   &c00000000      TextFont        =   "SmallSystem"      TextSize        =   0.0      TextUnit        =   0      Top             =   55      Underline       =   False      UseFocusRing    =   True      Visible         =   True      Width           =   381   End   Begin Separator Separator1      AutoDeactivate  =   True      Enabled         =   True      Height          =   4      HelpTag         =   ""      Index           =   -2147483648      InitialParent   =   ""      Left            =   20      LockBottom      =   True      LockedInPosition=   False      LockLeft        =   True      LockRight       =   True      LockTop         =   False      Scope           =   0      TabIndex        =   6      TabPanelIndex   =   0      TabStop         =   True      Top             =   130      Visible         =   True      Width           =   450   End   Begin BetterPushButton RegisterButton      AutoDeactivate  =   True      Bold            =   False      ButtonStyle     =   "0"      Cancel          =   False      Caption         =   "Register"      Default         =   True      Enabled         =   False      Height          =   20      HelpTag         =   ""      Index           =   -2147483648      InitialParent   =   ""      Italic          =   False      Left            =   390      LockBottom      =   True      LockedInPosition=   False      LockLeft        =   False      LockRight       =   True      LockTop         =   False      Scope           =   0      TabIndex        =   8      TabPanelIndex   =   0      TabStop         =   True      TextFont        =   "SmallSystem"      TextSize        =   0.0      TextUnit        =   0      Top             =   146      Underline       =   False      Visible         =   True      Width           =   80   End   Begin BetterPushButton CancelButton      AutoDeactivate  =   True      Bold            =   False      ButtonStyle     =   "0"      Cancel          =   True      Caption         =   "Cancel"      Default         =   False      Enabled         =   True      Height          =   20      HelpTag         =   ""      Index           =   -2147483648      InitialParent   =   ""      Italic          =   False      Left            =   298      LockBottom      =   True      LockedInPosition=   False      LockLeft        =   False      LockRight       =   True      LockTop         =   False      Scope           =   0      TabIndex        =   7      TabPanelIndex   =   0      TabStop         =   True      TextFont        =   "SmallSystem"      TextSize        =   0.0      TextUnit        =   0      Top             =   146      Underline       =   False      Visible         =   True      Width           =   80   End   Begin Separator Separator2      AutoDeactivate  =   True      Enabled         =   True      Height          =   4      HelpTag         =   ""      Index           =   -2147483648      InitialParent   =   ""      Left            =   20      LockBottom      =   False      LockedInPosition=   False      LockLeft        =   True      LockRight       =   True      LockTop         =   False      Scope           =   0      TabIndex        =   1      TabPanelIndex   =   0      TabStop         =   True      Top             =   39      Visible         =   True      Width           =   450   End   Begin TextField KeyField      AcceptTabs      =   False      Alignment       =   0      AutoDeactivate  =   True      AutomaticallyCheckSpelling=   False      BackColor       =   &cFFFFFF00      Bold            =   False      Border          =   True      CueText         =   ""      DataField       =   ""      DataSource      =   ""      Enabled         =   True      Format          =   ""      Height          =   22      HelpTag         =   ""      Index           =   -2147483648      InitialParent   =   ""      Italic          =   False      Left            =   89      LimitText       =   0      LockBottom      =   False      LockedInPosition=   False      LockLeft        =   False      LockRight       =   False      LockTop         =   False      Mask            =   ""      Password        =   False      ReadOnly        =   False      Scope           =   0      TabIndex        =   5      TabPanelIndex   =   0      TabStop         =   True      Text            =   ""      TextColor       =   &c00000000      TextFont        =   "SmallSystem"      TextSize        =   0.0      TextUnit        =   0      Top             =   89      Underline       =   False      UseFocusRing    =   True      Visible         =   True      Width           =   381   End   Begin Label RegistrationField11      AutoDeactivate  =   True      Bold            =   True      DataField       =   ""      DataSource      =   ""      Enabled         =   True      Height          =   20      HelpTag         =   ""      Index           =   -2147483648      InitialParent   =   ""      Italic          =   False      Left            =   20      LockBottom      =   False      LockedInPosition=   False      LockLeft        =   False      LockRight       =   False      LockTop         =   False      Multiline       =   False      Scope           =   0      Selectable      =   False      TabIndex        =   2      TabPanelIndex   =   0      Text            =   "Name:"      TextAlign       =   0      TextColor       =   &c00000000      TextFont        =   "System"      TextSize        =   0.0      TextUnit        =   0      Top             =   54      Transparent     =   True      Underline       =   False      Visible         =   True      Width           =   57   End   Begin Label RegistrationField111      AutoDeactivate  =   True      Bold            =   True      DataField       =   ""      DataSource      =   ""      Enabled         =   True      Height          =   20      HelpTag         =   ""      Index           =   -2147483648      InitialParent   =   ""      Italic          =   False      Left            =   20      LockBottom      =   False      LockedInPosition=   False      LockLeft        =   False      LockRight       =   False      LockTop         =   False      Multiline       =   False      Scope           =   0      Selectable      =   False      TabIndex        =   4      TabPanelIndex   =   0      Text            =   "Key:"      TextAlign       =   0      TextColor       =   &c00000000      TextFont        =   "System"      TextSize        =   0.0      TextUnit        =   0      Top             =   88      Transparent     =   True      Underline       =   False      Visible         =   True      Width           =   57   EndEnd#tag EndWindow#tag WindowCode	#tag Method, Flags = &h0		Sub Constructor(db As CubeSQLServer, parentWindow as Window)		  Super.Window()		  mdb = db		  me.ShowModalWithin(parentWindow)		End Sub	#tag EndMethod	#tag Property, Flags = &h21		Private mdb As CubeSQLServer	#tag EndProperty#tag EndWindowCode#tag Events NameField	#tag Event		Sub TextChange()		  RegisterButton.Enabled = ((NameField.Text.Len > 0) and (KeyField.Text.Len > 0))		End Sub	#tag EndEvent#tag EndEvents#tag Events RegisterButton	#tag Event		Sub Action()		  Dim sql As String		  Dim name As String = NameField.Text		  		  if (name.InStr("'")<>0) then		    sql = "SET BASE64 REGISTRATION TO '" + EncodeBase64(name) + "' WITH KEY '" +KeyField.Text + "';"		  else		    sql = "SET REGISTRATION TO '" + name + "' WITH KEY '" +KeyField.Text + "';"		  end if		  mdb.SQLExecute(sql)		  		  if (mdb.Error) then		    MsgBox mdb.ErrorMessage + EndOfLine + EndOfLine + "Error code:" + Str(mdb.ErrorCode)		    return		  else		    MsgBox "Thanks for registering cubeSQL Server!"		  end if		  		  me.Window.Close		End Sub	#tag EndEvent#tag EndEvents#tag Events CancelButton	#tag Event		Sub Action()		  me.Window.Close		End Sub	#tag EndEvent#tag EndEvents#tag Events KeyField	#tag Event		Sub TextChange()		  RegisterButton.Enabled = ((NameField.Text.Len > 0) and (KeyField.Text.Len > 0))		End Sub	#tag EndEvent#tag EndEvents