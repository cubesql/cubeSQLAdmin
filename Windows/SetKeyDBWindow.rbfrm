#tag WindowBegin Window SetKeyDBWindow   BackColor       =   16777215   Backdrop        =   ""   CloseButton     =   True   Composite       =   True   Frame           =   8   FullScreen      =   False   HasBackColor    =   False   Height          =   124   ImplicitInstance=   True   LiveResize      =   True   MacProcID       =   0   MaxHeight       =   32000   MaximizeButton  =   False   MaxWidth        =   32000   MenuBar         =   ""   MenuBarVisible  =   True   MinHeight       =   64   MinimizeButton  =   True   MinWidth        =   64   Placement       =   0   Resizeable      =   False   Title           =   "Set Database Key"   Visible         =   True   Width           =   462   Begin BetterPushButton DBKeySetButton      AutoDeactivate  =   True      Bold            =   ""      ButtonStyle     =   0      Cancel          =   ""      Caption         =   "Save"      Default         =   True      Enabled         =   False      Height          =   20      HelpTag         =   ""      Index           =   -2147483648      InitialParent   =   ""      Italic          =   ""      Left            =   362      LockBottom      =   ""      LockedInPosition=   False      LockLeft        =   ""      LockRight       =   ""      LockTop         =   ""      Scope           =   0      TabIndex        =   3      TabPanelIndex   =   0      TabStop         =   True      TextFont        =   "SmallSystem"      TextSize        =   0      TextUnit        =   0      Top             =   84      Underline       =   ""      Visible         =   True      Width           =   80   End   Begin BetterPushButton DBKeyCancelButton      AutoDeactivate  =   True      Bold            =   ""      ButtonStyle     =   0      Cancel          =   True      Caption         =   "Cancel"      Default         =   ""      Enabled         =   True      Height          =   20      HelpTag         =   ""      Index           =   -2147483648      InitialParent   =   ""      Italic          =   ""      Left            =   270      LockBottom      =   ""      LockedInPosition=   False      LockLeft        =   ""      LockRight       =   ""      LockTop         =   ""      Scope           =   0      TabIndex        =   2      TabPanelIndex   =   0      TabStop         =   True      TextFont        =   "SmallSystem"      TextSize        =   0      TextUnit        =   0      Top             =   84      Underline       =   ""      Visible         =   True      Width           =   80   End   Begin TextField DBKeyField      AcceptTabs      =   ""      Alignment       =   0      AutoDeactivate  =   True      AutomaticallyCheckSpelling=   False      BackColor       =   16777215      Bold            =   ""      Border          =   True      CueText         =   ""      DataField       =   ""      DataSource      =   ""      Enabled         =   True      Format          =   ""      Height          =   22      HelpTag         =   ""      Index           =   -2147483648      InitialParent   =   ""      Italic          =   ""      Left            =   16      LimitText       =   0      LockBottom      =   ""      LockedInPosition=   False      LockLeft        =   ""      LockRight       =   ""      LockTop         =   ""      Mask            =   ""      Password        =   True      ReadOnly        =   ""      Scope           =   0      TabIndex        =   1      TabPanelIndex   =   0      TabStop         =   True      Text            =   ""      TextColor       =   0      TextFont        =   "SmallSystem"      TextSize        =   0      TextUnit        =   0      Top             =   50      Underline       =   ""      UseFocusRing    =   True      Visible         =   True      Width           =   426   End   Begin Label DBKeyTitle      AutoDeactivate  =   True      Bold            =   True      DataField       =   ""      DataSource      =   ""      Enabled         =   True      Height          =   20      HelpTag         =   ""      Index           =   -2147483648      InitialParent   =   ""      Italic          =   ""      Left            =   16      LockBottom      =   ""      LockedInPosition=   False      LockLeft        =   ""      LockRight       =   ""      LockTop         =   ""      Multiline       =   ""      Scope           =   0      Selectable      =   False      TabIndex        =   0      TabPanelIndex   =   0      Text            =   ""      TextAlign       =   0      TextColor       =   0      TextFont        =   "SmallSystem"      TextSize        =   0      TextUnit        =   0      Top             =   18      Transparent     =   True      Underline       =   ""      Visible         =   True      Width           =   426   EndEnd#tag EndWindow#tag WindowCode	#tag Method, Flags = &h0		Sub Constructor(db As CubeSQLServer, dbname As String, parentWindow as Window)		  Super.Window()		  mdb = db		  mdbname = dbname		  DBKeyTitle.Text = "Key for database " + mdbname		  		  me.ShowModalWithin(parentWindow)		End Sub	#tag EndMethod	#tag Method, Flags = &h21		Private Function DoExecute(sql As String) As Boolean		  mdb.SQLExecute(sql)		  if (mdb.Error) then		    MsgBox mdb.ErrorMessage + EndOfLine + EndOfLine + "Error code:" + Str(mdb.ErrorCode)		    return false		  end if		  		  return true		End Function	#tag EndMethod	#tag Property, Flags = &h21		Private mdb As CubeSQLServer	#tag EndProperty	#tag Property, Flags = &h21		Private mdbname As String	#tag EndProperty#tag EndWindowCode#tag Events DBKeySetButton	#tag Event		Sub Action()		  Dim sql As String = "SET KEY '" +DBKeyField.Text + "' FOR DATABASE '" + mdbname +"'"		  if (DoExecute(sql)) then me.Window.Close		End Sub	#tag EndEvent#tag EndEvents#tag Events DBKeyCancelButton	#tag Event		Sub Action()		  me.Window.Close		End Sub	#tag EndEvent#tag EndEvents#tag Events DBKeyField	#tag Event		Sub TextChange()		  DBKeySetButton.Enabled = (me.text.len > 0)		End Sub	#tag EndEvent#tag EndEvents